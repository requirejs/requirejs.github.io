<!DOCTYPE html>
<html>
<head>
    <title>CommonJS Notes</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="../main.css">
    <link rel="icon" type="image/x-icon" href="/favicon.png">
    <!--[if IE]> <link rel="stylesheet" type="text/css" href="../ie.css" /> <![endif]-->
    <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/dojo/1.4/dojox/highlight/resources/highlight.css">

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
    <script type="text/javascript" src="../init.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/dojo/1.4/dojo/dojo.xd.js"></script>
    <script type="text/javascript">
        dojo.registerModulePath("dojo", "https://ajax.googleapis.com/ajax/libs/dojo/1.4.4/dojo");
        dojo.registerModulePath("dojox", "https://ajax.googleapis.com/ajax/libs/dojo/1.4.4/dojox");
        dojo.require("dojox.highlight");
        dojo.require("dojox.highlight.languages.javascript");
        dojo.require("dojox.highlight.languages.html");
        dojo.ready(function() {
            dojo.query("pre > code")
                .forEach(function(node) {
                    if (node.innerHTML.indexOf("DOCTYPE") !== -1 || node.innerHTML.indexOf('&lt;script') !== -1) {
                        dojo.addClass(node, "html");
                    } else {
                        dojo.addClass(node, "javascript");
                    }
                })
                .forEach(dojox.highlight.init);
        });
    </script>
</head>
<body>
<div id="grid"></div>
<div id="wrapper">

    <div id="navBg"></div>
    <button type="button" role="button" aria-label="Toggle Navigation" class="off-canvas-button">
      <span class="lines">
        <span class="line">&nbsp;</span>
        <span class="line">&nbsp;</span>
        <span class="line">&nbsp;</span>
      </span>
      <span class="cross">&times;</span>
    </button>
    <div id="nav" class="mono">
        <a class="homeImageLink" href="../"></a>
        <h1>a javascript module loader</h1>

        <ul>
            <li class="hbox">
                <a href="../">Home</a>
                <span class="spacer boxFlex"></span>
                <span class="icon home"></span>
            </li>
        </ul>

        <ul>
            <li class="hbox">
                <a class="local" href="start.html">Start</a>
                <span class="spacer boxFlex"></span>
                <span class="icon start"></span>
            </li>
            <li class="hbox">
                <a class="local" href="download.html">Download</a>
                <span class="spacer boxFlex"></span>
                <span class="icon download"></span>
            </li>
            <li class="hbox">
                <a class="local" href="api.html">API</a>
                <span class="spacer boxFlex"></span>
                <span class="icon api"></span>
            </li>
            <li class="hbox">
                <a class="local" href="optimization.html">Optimization</a>
                <span class="spacer boxFlex"></span>
                <span class="icon optimize"></span>
            </li>
        </ul>

        <ul>
            <li class="hbox">
                <a class="local" href="jquery.html">Use with jQuery</a>
                <span class="spacer boxFlex"></span>
                <span class="icon script"></span>
            </li>
            <li class="hbox">
                <a class="local" href="node.html">Use with Node</a>
                <span class="spacer boxFlex"></span>
                <span class="icon script"></span>
            </li>
            <li class="hbox">
                <a class="local" href="dojo.html">Use with Dojo</a>
                <span class="spacer boxFlex"></span>
                <span class="icon script"></span>
            </li>
            <li class="hbox">
                <a class="local" href="commonjs.html">CommonJS Notes</a>
                <span class="spacer boxFlex"></span>
                <span class="icon script"></span>
            </li>
        </ul>

        <ul>
            <li class="hbox">
                <a class="local" href="faq.html">FAQs</a>
                <span class="spacer boxFlex"></span>
                <span class="icon question"></span>
            </li>
            <li class="hbox">
                <a class="local" href="errors.html">Common Errors</a>
                <span class="spacer boxFlex"></span>
                <span class="icon question"></span>
            </li>
            <li class="hbox">
                <a class="local" href="plugins.html">Writing Plugins</a>
                <span class="spacer boxFlex"></span>
                <span class="icon api"></span>
            </li>
        </ul>

        <ul>
            <li class="hbox">
                <a class="local" href="why.html">Why Web Modules</a>
                <span class="spacer boxFlex"></span>
                <span class="icon question"></span>
            </li>
            <li class="hbox">
                <a class="local" href="whyamd.html">Why AMD</a>
                <span class="spacer boxFlex"></span>
                <span class="icon question"></span>
            </li>
            <li class="hbox">
                <a class="local" href="requirements.html">Requirements</a>
                <span class="spacer boxFlex"></span>
                <span class="icon requirement"></span>
            </li>
            <li class="hbox">
                <a class="local" href="history.html">History</a>
                <span class="spacer boxFlex"></span>
                <span class="icon history"></span>
            </li>
        </ul>

        <ul>
            <li class="hbox">
                <a href="https://stackoverflow.com/questions/tagged/requirejs">Get Help</a>
                <span class="spacer boxFlex"></span>
                <span class="icon help"></span>
            </li>
            <li class="hbox">
                <a href="https://jrburke.com/">Blog</a>
                <span class="spacer boxFlex"></span>
                <span class="icon blog"></span>
            </li>
            <li class="hbox">
                <a href="https://twitter.com/jrburke">Twitter</a>
                <span class="spacer boxFlex"></span>
                <span class="icon twitter"></span>
            </li>
        </ul>

        <ul>
            <li class="hbox">
                <a href="https://github.com/requirejs/requirejs">GitHub</a>
                <span class="spacer boxFlex"></span>
                <span class="icon git"></span>
            </li>
            <li class="hbox">
                <a class="local" href="contributing.html">Contributing</a>
                <span class="spacer boxFlex"></span>
                <span class="icon fork"></span>
            </li>
        </ul>


        <ul>
            <li class="version">2.3.7 Docs (<a href="https://github.com/requirejs/requirejs/wiki/Upgrading-to-RequireJS-2.1">upgrade info</a>)</li>
        </ul>

    </div>

    <div id="content">
<div id="directory" class="section">
<h1>CommonJS Notes</h1>

<ul class="index mono">
<li class="hbox"><a href="#intro">Introduction</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1</span></li>
<li class="hbox"><a href="#manualconversion">Manual Conversion</a><span class="spacer boxFlex"></span><span class="sect">&sect; 2</span></li>
<li class="hbox"><a href="#autoconversion">Conversion Tool</a><span class="spacer boxFlex"></span><span class="sect">&sect; 3</span></li>
<li class="hbox"><a href="#exports">Setting Exported Value</a><span class="spacer boxFlex"></span><span class="sect">&sect; 4</span></li>
<li class="hbox"><a href="#altsyntax">Alternative Syntax</a><span class="spacer boxFlex"></span><span class="sect">&sect; 5</span></li>
<li class="hbox"><a href="#packages">Loading Modules from CommonJS Packages</a><span class="spacer boxFlex"></span><span class="sect">&sect; 6</span></li>
<li class="hbox"><a href="#optimize">Optimization Tool</a><span class="spacer boxFlex"></span><span class="sect">&sect; 7</span></li>
</ul>

</div>

<div class="section">
<h2><a name="intro">Introduction</a><span class="sectionMark">&sect; 1</span></h2>

<p><a href="http://www.commonjs.org/">CommonJS</a> defines <a href="http://wiki.commonjs.org/wiki/Modules/1.1.1">a module format</a>. Unfortunately, it was defined without giving browsers equal footing to other JavaScript environments. Because of that, there are CommonJS spec proposals for <a href="http://wiki.commonjs.org/wiki/Modules/Transport">Transport formats</a> and an <a href="http://wiki.commonjs.org/wiki/Modules/Async/A">asynchronous require</a>.</p>

<p>RequireJS tries to keep with the spirit of CommonJS, with using string names to refer to dependencies, and to avoid modules defining global objects, but still allow coding a module format that works well natively in the browser. RequireJS implements the <a href="http://wiki.commonjs.org/wiki/Modules/AsynchronousDefinition">Asynchronous Module Definition</a> (formerly Transport/C) proposal.</p>

<p>If you have modules that are in the traditional CommonJS module format, then you can easily convert them to work with RequireJS. Not all modules will convert cleanly to the new format. Types of modules that may not convert well:</p>

<ul>
    <li>Modules that use conditional code to do a require call, like if(someCondition) require('a1') else require('a2');</li>
    <li>Some types of circular dependencies.</li>
</div>

<div class="section">
<h2><a name="manualconversion">Manual Conversion</a><span class="sectionMark">&sect; 2</span></h2>

<p>If you just have a few modules to convert, then all you need to do is wrap the module in this code:</p>

<pre><code>define(function(require, exports, module) {
    //Put traditional CommonJS module content here
});
</code></pre>

<p><strong>IMPORTANT</strong>: The function arguments should always be listed as <strong>require, exports, module</strong>, with those exact names and in that exact order, otherwise chaos will ensue. You can leave off exports and module from the list, but if they are needed, they need to be specified in the exact order illustrated here.</p>
</div>

<div class="section">
<h2><a name="autoconversion">Conversion Tool</a><span class="sectionMark">&sect; 3</span></h2>

<p>If you have many modules to convert, the <a href="https://github.com/requirejs/r.js">r.js project</a> has a converter tool built into the r.js file. Give it the path to the directory you want to convert and an output directory:</p>

<pre><code>node r.js -convert path/to/commonjs/modules/ path/to/output
</code></pre>

<p>There are a small number of CommonJS modules do not work well as
define()-wrapped modules. See the <a href="https://github.com/requirejs/r.js">r.js README</p> for more
information.</p>

</div>

<div class="section">
<h2><a name="exports">Setting Exported Value</a><span class="sectionMark">&sect; 4</span></h2>

<p>There are some CommonJS systems, mainly Node, that allow setting the exported value by assigning the exported value as module.exports. That idiom is supported by RequireJS, but there is another, easier way -- just return the value from the function passed to <strong>define</strong>:</p>

<pre><code>define(function (require) {
    var foo = require('foo');

    //Define this module as exporting a function
    return function () {
        foo.doSomething();
    };
});
</code></pre>

<p>With this approach, then you normally do not need the exports and module function arguments, so you can leave them off the module definition.</p>
</div>

<div class="section">
<h2><a name="altsyntax">Alternative Syntax</a><span class="sectionMark">&sect; 5</span></h2>

<p>Instead of using require() to get dependencies inside the function passed to define(), you can also specify them via a dependency array argument to define(). The order of the names in the dependency array match the order of arguments passed to the definition function passed to define(). So the above example that uses the module <strong>foo</strong>:</p>

<pre><code>define(['foo'], function (foo) {
    return function () {
        foo.doSomething();
    };
});
</code></pre>

<p>See the <a href="api.html">API docs</a> for more information on that syntax.</p>
</div>

<div class="section">
<h2><a name="packages">Loading Modules from CommonJS Packages</a><span class="sectionMark">&sect; 6</span></h2>

<p>Modules in CommonJS packages can be loaded by RequireJS by setting up the RequireJS configuration to know about the location and package attributes. See the <a href="api.html#packages">packages API section</a> for more information.</p>
</div>

<div class="section">
<h2><a name="optimize">Optimization Tool</a><span class="sectionMark">&sect; 7</span></h2>

<p>RequireJS has an optimization tool that can combine module definitions together into optimized bundles for browser delivery. It works as a command-line tool that you use as part of code deployment. See the <a href="optimization.html">optimization docs</a> for more information.</p>
</div>
    </div>
    <div id="footer" class="mono">
        <span class="line">Latest Release: <a href="https://requirejs.org/docs/download.html">2.3.7</a></span>
        <span class="line">Code is open source: <a href="https://github.com/requirejs/requirejs/blob/master/LICENSE">new BSD or MIT licensed</a></span>
        <span class="line">logo and web design by <a href="http://andychung.me/">Andy Chung</a> <a href="https://github.com/requirejs/requirejs-branding">&copy; 2010-2018</a></span>
    </div>
</div>

</body>
</html>
